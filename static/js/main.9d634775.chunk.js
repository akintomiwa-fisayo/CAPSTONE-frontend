(this["webpackJsonpcapstone-frontend"]=this["webpackJsonpcapstone-frontend"]||[]).push([[0],[,,,,,,,,,,,,,,,,function(e,t,a){e.exports=a.p+"static/media/coverimage.5afb4beb.jpg"},function(e,t,a){},,,,,,,,,,function(e,t,a){e.exports=a(56)},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(23),o=a.n(s),i=(a(32),a(2)),c=a(3),l=a(5),u=a(4),p=a(6),m=a(9),d=a(13),f=(a(33),a(7)),h=a(1),g=function(e){return document.querySelector(e)},v={isEmpty:function(e){return!e||!e.trim()},isElement:function(e){return"object"===typeof HTMLElement?e instanceof HTMLElement:e&&"object"===typeof e&&null!==e&&1===e.nodeType&&"string"===typeof e.nodeName},isEmail:function(e){return!(!1===/[a-z0-9]+@+[a-z0-9]+\.+[a-z]{3,}/i.test(e)||!0===/[^a-z0-9.@]/i.test(e))},isDescendant:function(e,t){var a="string"===typeof t?document.querySelectorAll(t):t,n=v.isElement(e)?e:document.querySelector(e),r=0;if(v.isElement(a)){if(t.contains(n))return t}else if(a)for(r=a.length;n&&"HTML"!==n.tagName;){for(var s=0;s<r;s+=1)if(n===a[s])return n;n=n.parentElement}return!1},isUpperCase:function(e){return!(e.toUpperCase()===e.toLowerCase()||e!==e.toUpperCase())},isLowerCase:function(e){return!(e.toUpperCase()===e.toLowerCase()||e!==e.toLowerCase())},sepCamelWord:function(e){for(var t=e.length-1,a="";t>=0;t-=1)a=v.isUpperCase(e[t])?" ".concat(e[t].toLowerCase()).concat(a):"".concat(e[t]).concat(a);return a},popMessage:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4500,a=300,n=function(e){setTimeout((function(){e.classList.add("show")}),100)},r=document.querySelector("#popMessage"),s=document.createElement("DIV");s.classList="message",s.innerHTML=e,r?(r.appendChild(s),n(s)):(r=document.createElement("DIV"),r.id="popMessage",r.appendChild(s),document.querySelector("#root").appendChild(r),n(s)),setTimeout((function(){s.classList.remove("show"),setTimeout((function(){r.removeChild(s),r.children[0]||document.querySelector("#root").removeChild(r)}),a)}),t)},deleteIndex:function(e){for(var t=[],a=arguments.length<=1?0:arguments.length-1,n=!0,r=0;r<e.length;r+=1){n=!0;for(var s=0;s<a;s+=1){var o=s+1<1||arguments.length<=s+1?void 0:arguments[s+1];if(r===o){n=!1;break}}n&&t.push(e[r])}return"string"===typeof e?t.join(""):t},getWeekDay:function(e){return!isNaN(e)&&["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][e]},getMonth:function(e){return!isNaN(e)&&["january","february","march","april","may","june","july","august","september","october","november","december"][e]},getRelativeTime:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=new Date,n=new Date(e),r="",s=n.getFullYear();s=a.getFullYear()>s?s:"";var o=v.getMonth(n.getMonth()),i=n.getHours(),c=i>=12?"pm":"am";i=0===i?12:i>12?i-12:i;var l=n.getDate()+1,u=n.getMinutes(),p="".concat(u);p=1===p.length?"0".concat(p):p;var m=v.getWeekDay(n.getDay());if(t){var d=a-n,f=Math.floor(d/1e3);if(f>=60){var h=Math.floor(f/60);if(h>=60){var g=Math.floor(h/60);if(g>=24){var b=Math.floor(g/24);r=b>=7?"".concat(m," ").concat(o," ").concat(l," ").concat(s," at ").concat(i,":").concat(p," ").concat(c):1===b?"yesterday at ".concat(i,":").concat(p," ").concat(c):"last ".concat(m," at ").concat(i,":").concat(p," ").concat(c)}else r="".concat(g,"hr").concat(g>1?"s":""," ago")}else r="".concat(h,"min").concat(h>1?"s":""," ago")}else r="just now"}else r="".concat(m," ").concat(o," ").concat(l," ").concat(s," at ").concat(i,":").concat(p," ").concat(c);return r},getCordinates:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g("html"),a=v.isElement(e)?e:g(e),n=a.offsetLeft-t.scrollLeft,r=a.offsetTop-t.scrollTop;return{left:n,top:r}},parseURI:function(e,t){var a=function(e){var t=e.split("?")[0].split("/");return""===t[t.length-1]&&t.pop(),t},n=a(e),r=a(t),s=n.length;if(s===r.length){for(var o={},i="",c="",l=0;l<s;l+=1)if(":"===n[l][0])i=v.deleteIndex(n[l],0),c=r[l],o[i]=c;else if(n[l]!==r[l])return!1;return o}return!1}},b=v,y=(a(34),a(16)),E=a.n(y);function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function j(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(a,!0).forEach((function(t){Object(f.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var w=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={submitting:!1,isValidForm:!0,error:"The email or password you entered is not correct, please try again.",email:{state:"empty",value:"",focused:"",invalid:""},password:{state:"empty",value:"",focused:"",invalid:""}},a._isMounted=!1,a.submitForm=a.submitForm.bind(Object(h.a)(a)),a.regFieldInput=a.regFieldInput.bind(Object(h.a)(a)),a.blurField=a.blurField.bind(Object(h.a)(a)),a.focusField=a.focusField.bind(Object(h.a)(a)),a.clickTofocusField=a.clickTofocusField.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"submitForm",value:function(){var e=this;if(!1===this.state.submitting){var t=this.state.email,a=this.state.password;"filled"===t.state&&"filled"===a.state?(this.setState((function(){return{submitting:!0}})),fetch("https://akintomiwa-capstone-backend.herokuapp.com/api/v1/auth/signin",{method:"POST",body:JSON.stringify({username:t.value,password:a.value}),headers:{"Content-Type":"application/json"}}).then((function(e){if(200===e.status)return e.json();throw new Error(e.status)})).then((function(t){var a=t.data,n=e.props.history;localStorage.setItem("sessionUserToken",a.token),localStorage.setItem("sessionUserId",a.userId),n.push("/")})).catch((function(t){var a=t.message,n=parseInt(a,10);e._isMounted&&(500===n?e.setState((function(){return{isValidForm:!1,error:"Oops!, there was a server error, please try again"}})):400===n&&e.setState((function(){return{isValidForm:!1,error:"The email or password you entered is not correct, please try again."}})),e.setState((function(){return{submitting:!1}})))}))):("filled"!==t.state&&this.setState((function(e){return{email:j({},e.email,{invalid:"invalid"})}})),"filled"!==a.state&&this.setState((function(e){return{password:j({},e.password,{invalid:"invalid"})}})),this.setState((function(){return{error:"You need both email and password to sign in",isValidForm:!1}})))}}},{key:"clickTofocusField",value:function(e){"focused"!==("email"===e.target.getAttribute("name")?this.state.email.focused:this.state.password.focused)&&b.isDescendant(e.target,".hero-input").querySelector(".hero-input-field").focus()}},{key:"focusField",value:function(e){var t=e.target.getAttribute("name");this.setState((function(e){return"email"===t?{email:j({},e.email,{focused:"focused"})}:{password:j({},e.password,{focused:"focused"})}}))}},{key:"regFieldInput",value:function(e){var t=e.target.getAttribute("name");if("email"===t||"password"===t){var a=e.target.value,n=b.isEmpty(a)?"empty":"filled";this.setState((function(){return"email"===t?{email:{state:n,focused:"focused",invalid:"",value:a}}:{password:{state:n,focused:"focused",invalid:"",value:a}}}))}}},{key:"blurField",value:function(e){var t=e.target.getAttribute("name");this.setState((function(e){return"email"===t?{email:j({},e.email,{focused:""})}:{password:j({},e.password,{focused:""})}}))}},{key:"render",value:function(){return r.a.createElement("div",{id:"pageContent","data-page":"signin"},r.a.createElement("img",{id:"pageBK",src:E.a,alt:""}),r.a.createElement("div",{id:"siteLogoHolder"},r.a.createElement("span",{id:"siteLogo"},"ignite")),r.a.createElement("div",{id:"contentHolder"},r.a.createElement("div",{id:"signInForm"},r.a.createElement("div",{id:"pageBKcloneHolder"},r.a.createElement("img",{id:"pageBKclone",src:E.a,alt:""})),r.a.createElement("div",{className:"form"},r.a.createElement("h1",{className:"label"},"sign in"),r.a.createElement("div",{id:"errorMessage",className:this.state.isValidForm?"hide":"show"},r.a.createElement("span",null,this.state.error)),r.a.createElement("div",{className:"".concat(this.state.email.state," ").concat(this.state.email.focused," ").concat(this.state.email.invalid," hero-input form-element mandatory"),onClick:this.clickTofocusField,name:"email"},r.a.createElement("p",{className:"hero-input-label"},r.a.createElement("span",null,"email")),r.a.createElement("input",{type:"text",name:"email",className:"hero-input-field",onInput:this.regFieldInput,onBlur:this.blurField,onFocus:this.focusField})),r.a.createElement("div",{className:"".concat(this.state.password.state," ").concat(this.state.password.focused," ").concat(this.state.password.invalid," hero-input form-element mandatory"),onClick:this.clickTofocusField,name:"password"},r.a.createElement("p",{className:"hero-input-label"},r.a.createElement("span",null,"password")),r.a.createElement("input",{type:"password",name:"password",className:"hero-input-field",onInput:this.regFieldInput,onBlur:this.blurField,onFocus:this.focusField})),r.a.createElement("button",{type:"button",id:"signInBtn",className:"btn ".concat(!0===this.state.submitting?"disabled":""," "),onClick:this.submitForm},"sign in")))))}}]),t}(r.a.Component);a(35);function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(a,!0).forEach((function(t){Object(f.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var P={submitting:!1,password:{state:"empty",value:"",focused:"",invalid:""},conPassword:{state:"empty",value:"",focused:"",invalid:""},newPassword:{state:"empty",value:"",focused:"",invalid:""},error:!1},D=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state=P,a._isMounted=!1,a.regFieldInput=a.regFieldInput.bind(Object(h.a)(a)),a.blurField=a.blurField.bind(Object(h.a)(a)),a.focusField=a.focusField.bind(Object(h.a)(a)),a.clickTofocusField=a.clickTofocusField.bind(Object(h.a)(a)),a.changePassword=a.changePassword.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"clickTofocusField",value:function(e){var t=b.isDescendant(e.target,".hero-input.form-element");t&&(t=t.getAttribute("data-field"),"focused"!==this.state[t].focused&&b.isDescendant(e.target,".hero-input").querySelector(".hero-input-field").focus())}},{key:"focusField",value:function(e){var t=e.target.getAttribute("name");this.setState((function(e){var a=N({},e[t],{focused:"focused"}),n={};return n[t]=a,n}))}},{key:"blurField",value:function(e){var t=e.target.getAttribute("name");this.setState((function(e){var a=N({},e[t],{focused:""}),n={};return n[t]=a,n}))}},{key:"regFieldInput",value:function(e){var t=e.target.getAttribute("name"),a=e.target.value,n=b.isEmpty(a)?"empty":"filled";this.setState((function(){var e={state:n,focused:"focused",invalid:"",value:a},r={};return r[t]=e,r}))}},{key:"changePassword",value:function(){var e=this,t=this.state;if(!t.submitting){var a=t.password,n=t.newPassword,r=t.conPassword;b.isEmpty(a.value)?this.setState((function(e){return{password:N({},e.password,{invalid:"invalid"}),error:"you need to input your current password"}})):n.value.length<8?this.setState((function(e){return{newPassword:N({},e.newPassword,{invalid:"invalid"}),conPassword:N({},e.conPassword,{invalid:"invalid"}),error:"password needs to be atleast 8 character long"}})):n.value!==r.value?this.setState((function(e){return{newPassword:N({},e.newPassword,{invalid:"invalid"}),conPassword:N({},e.conPassword,{invalid:"invalid"}),error:"the specified passwords do not match"}})):(this.setState((function(){return{submitting:!0}})),this.props.fetchRequest({url:"https://akintomiwa-capstone-backend.herokuapp.com/api/v1/auth/password",method:"patch",body:'{\n            "oldPassword" : "'.concat(a.value,'",\n            "newPassword" : "').concat(n.value,'"\n          }'),headers:{"Content-Type":"application/json"}}).then((function(t){var a=t.token;e._isMounted&&e.setState((function(){return P})),localStorage.setItem("sessionUserToken",a),b.popMessage("password changed successfully")})).catch((function(t){e._isMounted&&("Old password incorrect"===t.body?e.setState((function(e){return{password:N({},e.password,{invalid:"invalid"}),error:"password incorrect",submitting:!1}})):(e.setState((function(){return{submitting:!0}})),b.popMessage("opps!, we were unable to complete your request, please try again")))})))}}},{key:"render",value:function(){return r.a.createElement("div",{id:"changePassForm"},r.a.createElement("p",{className:"error".concat(!1===this.state.error?" hide":"")},this.state.error),r.a.createElement("div",{className:"".concat(this.state.password.state," ").concat(this.state.password.focused," ").concat(this.state.password.invalid," hero-input form-element"),onClick:this.clickTofocusField,"data-field":"password"},r.a.createElement("p",{className:"hero-input-label"},r.a.createElement("span",null,"password")),r.a.createElement("input",{type:"password",name:"password",className:"hero-input-field",onChange:this.regFieldInput,onBlur:this.blurField,onFocus:this.focusField,value:this.state.password.value})),r.a.createElement("div",{className:"".concat(this.state.newPassword.state," ").concat(this.state.newPassword.focused," ").concat(this.state.newPassword.invalid," hero-input form-element"),onClick:this.clickTofocusField,"data-field":"newPassword"},r.a.createElement("p",{className:"hero-input-label"},r.a.createElement("span",null,"new password")),r.a.createElement("input",{type:"password",name:"newPassword",className:"hero-input-field",onChange:this.regFieldInput,onBlur:this.blurField,onFocus:this.focusField,value:this.state.newPassword.value})),r.a.createElement("div",{className:"".concat(this.state.conPassword.state," ").concat(this.state.conPassword.focused," ").concat(this.state.conPassword.invalid," hero-input form-element"),onClick:this.clickTofocusField,"data-field":"conPassword"},r.a.createElement("p",{className:"hero-input-label"},r.a.createElement("span",null,"confirm password")),r.a.createElement("input",{type:"password",name:"conPassword",className:"hero-input-field",onChange:this.regFieldInput,onBlur:this.blurField,onFocus:this.focusField,value:this.state.conPassword.value})),r.a.createElement("button",{type:"button",className:"btn ".concat(!0===this.state.submitting?"disabled":""," "),onClick:this.changePassword},"submit"))}}]),t}(r.a.Component),S=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"signOut",value:function(){localStorage.removeItem("sessionUserToken"),localStorage.removeItem("sessionUserId")}},{key:"render",value:function(){var e="",t="";return this.props.sessionUser.isAdmin&&(e=r.a.createElement(m.b,{className:"link",to:"/create-user"},r.a.createElement("span",{className:"icon fa fa-user-plus"}),"create user"),t=r.a.createElement(m.b,{className:"link",to:"/reports"},r.a.createElement("span",{className:"icon fa fa-bug"}),"reports")),r.a.createElement("div",{id:"navBlock"},r.a.createElement("span",{id:"siteLogo"},"ignite"),r.a.createElement("div",{className:"links"},e,t,r.a.createElement(m.b,{className:"link",to:"/feeds",isActive:function(e,t){return!!e||-1!==["","/"].indexOf(t.pathname.toLowerCase())}},r.a.createElement("span",{className:"icon fas fa-layer-group"}),"feeds"),r.a.createElement(m.b,{className:"link",to:"/profile"},r.a.createElement("span",{className:"icon fa fa-user-circle"}),"profile"),r.a.createElement(m.b,{className:"link",to:"/signin",exact:!0,onClick:this.signOut},r.a.createElement("span",{className:"icon fa fa-sign-out-alt"}),"sign out")),r.a.createElement("hr",null),r.a.createElement("div",{id:"accountPreference"},r.a.createElement("span",{className:"label"}," change password"),r.a.createElement(D,this.props)))}}]),t}(r.a.Component);function M(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?M(a,!0).forEach((function(t){Object(f.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):M(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var R=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={report:C({},e.report),willDelete:!1,dateTimeRef:"",submitting:!1},a._isMounted=!1,a.updatePostDateTimeRef=null,a.attendTo=a.attendTo.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,this.setState((function(e){return{dateTimeRef:b.getRelativeTime(e.report.reportedOn)}})),this.updatePostDateTimeRef=setInterval((function(){e._isMounted&&e.setState((function(e){return{dateTimeRef:b.getRelativeTime(e.report.reportedOn)}}))}),6e4)}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,clearInterval(this.updatePostDateTimeRef)}},{key:"attendTo",value:function(e){var t=this;if(!this.state.submitting){this.setState((function(){return{submitting:!0}}));this.props.fetchRequest({url:"https://akintomiwa-capstone-backend.herokuapp.com/api/v1/reports/".concat(this.state.report.reportId),method:"patch",body:'{\n        "action": "'.concat(e,'"\n      }'),headers:{"Content-Type":"application/json"}}).then((function(){t.setState((function(){return{willDelete:!0}})),setTimeout((function(){t._isMounted&&t.props.removeReport(t.state.report.reportId)}),500)}))}}},{key:"render",value:function(){var e=this,t=this.state,a=t.report,n="",s="";if("comment"===a.contentType){var o=a.comment;n=o.post,s=r.a.createElement("div",null,r.a.createElement("div",{className:"report-content"},r.a.createElement("div",{className:"head"},r.a.createElement("div",{className:"user-image"},r.a.createElement("a",{href:"/"},r.a.createElement("img",{src:o.author.passportUrl,alt:"".concat(o.author.firstName," ").concat(o.author.lastName)}))),r.a.createElement("a",{href:"/",className:"user-name"},"".concat(o.author.firstName," ").concat(o.author.lastName))),r.a.createElement("div",{className:""},o.comment)),r.a.createElement("div",{className:"trailer"}))}else n="article"===a.contentType?C({},a.article,{type:"article"}):C({},a.gif,{type:"gif"});var i="gif"===n.type?r.a.createElement("img",{className:"item",src:n.imageUrl,alt:""}):r.a.createElement("div",{className:"item"},n.article),c=t.willDelete?"remove":"";return r.a.createElement("div",{className:"report ".concat(a.contentType," ").concat(c),id:a.id,"data-type":a.type},r.a.createElement("div",{className:"head"},r.a.createElement("div",{className:"user-image"},r.a.createElement("a",{href:"man"},r.a.createElement("img",{src:a.reporter.passportUrl,alt:"".concat(a.reporter.firstName," ").concat(a.reporter.lastName)}))),r.a.createElement("div",null,r.a.createElement("a",{href:"man",className:"user-name"},"".concat(a.reporter.firstName," ").concat(a.reporter.lastName)),r.a.createElement("p",{className:"date-time","data-timestamp":a.reportedOn,title:b.getRelativeTime(a.reportedOn,!1)},t.dateTimeRef)),r.a.createElement("span",{className:"report-id"},a.reportId)),r.a.createElement("div",{className:"body"},r.a.createElement("div",{className:"report-details"},r.a.createElement("div",{className:"detail"},r.a.createElement("div",{className:"info"},"content"),r.a.createElement("div",{className:"value"},a.contentType)),r.a.createElement("div",{className:"detail"},r.a.createElement("div",{className:"info"},"flag"),r.a.createElement("div",{className:"value"},a.flag)),r.a.createElement("div",{className:"detail"},r.a.createElement("div",{className:"info"},"reason"),r.a.createElement("div",{className:"value"},a.reason))),s,r.a.createElement("div",{className:"report-content"},r.a.createElement("div",{className:"head"},r.a.createElement("div",{className:"user-image"},r.a.createElement("a",{href:"man"},r.a.createElement("img",{src:n.author.passportUrl,alt:"".concat(n.author.firstName," ").concat(n.author.lastName)}))),r.a.createElement("a",{href:"man",className:"user-name"},"".concat(n.author.firstName," ").concat(n.author.lastName))),r.a.createElement("div",{className:"title"},n.title),r.a.createElement("div",{className:"content"},i))),r.a.createElement("div",{className:"bottom"},r.a.createElement("button",{type:"button",className:"action btn btn-danger ".concat(t.submitting?"disabled":""),onClick:function(){e.attendTo("delete")}}," delete"),r.a.createElement("button",{type:"button",className:"action btn btn-warning ".concat(t.submitting?"disabled":""),onClick:function(){e.attendTo("ignore")}}," ignore")))}}]),t}(r.a.Component),F=(a(41),a(42),a(43),function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.history;return r.a.createElement("div",{id:"errorPage"},r.a.createElement("span",{role:"img",className:"icon"},"\ud83d\ude15"),r.a.createElement("h1",null,"4** Error"),r.a.createElement("p",null,"This page does not exist or you don&apost have access to it"),r.a.createElement("button",{type:"button",className:"btn",onClick:function(){e.push("/feeds")}},"Go back feeds"))}}]),t}(r.a.Component)),T=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={reports:[],loading:!0},a._isMounted=!1,a.fetchRequest=a.props.fetchRequest,a.loadReports=a.loadReports.bind(Object(h.a)(a)),a.removeReport=a.removeReport.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0,this.props.pageSwitch("reports"),this.props.sessionUser.isAdmin?this.loadReports():this.setState((function(){return{loading:!1}}))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"loadReports",value:function(){var e=this;this.fetchRequest({url:"https://akintomiwa-capstone-backend.herokuapp.com/api/v1/reports"}).then((function(t){!0===e._isMounted&&e.setState((function(){return{reports:t,loading:!1}}))})).catch((function(){!0===e._isMounted&&e.setState((function(){return{loading:!1}}))}))}},{key:"removeReport",value:function(e){for(var t=this.state.reports,a=[],n=0;n<t.length;n+=1)t[n].reportId!==e&&a.push(t[n]);this.setState((function(){return{reports:a}})),b.popMessage("Report attended to")}},{key:"render",value:function(){if(this.state.loading)return r.a.createElement("div",null,r.a.createElement("span",{className:"fa fa-spinner fa-spin loader"}));if(this.props.sessionUser.isAdmin){if(0===this.state.reports.length)return r.a.createElement("div",{className:"no-reports"},r.a.createElement("span",null,"there are no reports to show"));for(var e=this.state.reports,t=[],a=0;a<e.length;a+=1)t.push(r.a.createElement(R,Object.assign({},this.props,{report:e[a],key:e[a].reportId,removeReport:this.removeReport})));return r.a.createElement("div",{id:"reports"},t)}return r.a.createElement(F,this.props)}}]),t}(r.a.Component);a(44);function I(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var A=function(e){return document.querySelector(e)},U={submitting:!1,passport:null,firstName:"",lastName:"",email:"",department:"",jobRole:"",password:"",gender:"",address:"",emailError:"",passwordError:""},_=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?I(a,!0).forEach((function(t){Object(f.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):I(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},U,{departments:e.companyDeptStruc}),a._isMounted=!1,a.fetchRequest=a.props.fetchRequest,a.onJobRoleChange=a.onJobRoleChange.bind(Object(h.a)(a)),a.onDepartmentChange=a.onDepartmentChange.bind(Object(h.a)(a)),a.onGenderChange=a.onGenderChange.bind(Object(h.a)(a)),a.regInputsState=a.regInputsState.bind(Object(h.a)(a)),a.onDisplayChange=a.onDisplayChange.bind(Object(h.a)(a)),a.createUser=a.createUser.bind(Object(h.a)(a)),a.resetForm=a.resetForm.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0,this.props.sessionUser.isAdmin&&this.props.pageSwitch("createUser")}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"onDisplayChange",value:function(e){var t=this,a=e.target,n=A("#regDisplay"),r=a.files[0];if(r&&"image/jpeg"===r.type)if(r.size>5242880)b.popMessage("can't upload image larger than 5mb");else{var s=new FileReader;s.readAsDataURL(r),s.onerror=function(){b.popMessage("Oops!, we couldn't attach the file picked please try again or try another one")},s.onload=function(e){var a=e.target.result;A("#regPassport").src=a,n.classList.add("selected"),n.classList.remove("Error"),t._isMounted&&t.setState((function(){return{passport:r}}))}}else b.popMessage("Image as to be a JPEG (.jpg or .jpeg) file")}},{key:"onJobRoleChange",value:function(e){var t=e.target.value;this.setState((function(){return{jobRole:t}}))}},{key:"onDepartmentChange",value:function(e){var t=e.target.value;this.setState((function(){return{department:t,jobRole:""}}))}},{key:"onGenderChange",value:function(e){var t=e.target.value;this.setState((function(){return{gender:"male"===t||"female"===t?t:""}}))}},{key:"regInputsState",value:function(e){var t=e.target.name;if(-1!==Object.keys(this.state).indexOf(t)){var a=e.target.value;this.setState((function(){var e={};return e[t]=a,e})),b.isEmpty(a)||e.target.classList.remove("Error")}}},{key:"resetForm",value:function(){this._isMounted&&this.setState((function(){return U})),A("#regPassport").src="",A("#regPassportPicker").value=null}},{key:"createUser",value:function(){var e=this,t=this.state;if(!1===t.submitting){if(function(){var a=!1;null===t.passport?(A("#regDisplay").classList.add("Error"),a=!0):A("#regDisplay").classList.remove("Error"),b.isEmpty(t.firstName)?(A("#regForm .form-element[name=firstName]").classList.add("Error"),a=!0):A("#regForm .form-element[name=firstName]").classList.remove("Error"),b.isEmpty(t.lastName)?(A("#regForm .form-element[name=lastName]").classList.add("Error"),a=!0):A("#regForm .form-element[name=lastName]").classList.remove("Error");try{if(b.isEmpty(t.email))throw F;if(!b.isEmail(t.email))throw e.setState((function(){return{emailError:"not a valid email address"}})),F;e.setState((function(){return{emailError:""}})),A("#regForm .form-element[name=email]").classList.remove("Error")}catch(c){A("#regForm .form-element[name=email]").classList.add("Error"),a=!0}try{if(b.isEmpty(t.password))throw F;if(!(t.password.length>=8))throw e.setState((function(){return{passwordError:"password needs to be atleast 8 characters long"}})),F;e.setState((function(){return{passwordError:""}})),A("#regForm .form-element[name=password]").classList.remove("Error")}catch(c){A("#regForm .form-element[name=password]").classList.add("Error"),a=!0}-1===["male","female"].indexOf(t.gender)?(A("#regForm .form-element[name=gender]").classList.add("Error"),a=!0):A("#regForm .form-element[name=gender]").classList.remove("Error");var n=e.state.departments,r=e.state.department;if(-1===Object.keys(n).indexOf(r))A("#regForm .form-element[name=department]").classList.add("Error"),A("#regForm .form-element[name=jobRole]").classList.add("Error"),a=!0;else{A("#regForm .form-element[name=department]").classList.remove("Error");for(var s=n[r].jobRoles,o=!1,i=0;i<s.length;i+=1)if(s[i].id===e.state.jobRole){o=!0;break}o?A("#regForm .form-element[name=jobRole]").classList.remove("Error"):(a=!0,A("#regForm .form-element[name=jobRole]").classList.add("Error"))}return b.isEmpty(t.address)?(A("#regForm .form-element[name=address]").classList.add("Error"),a=!0):A("#regForm .form-element[name=address]").classList.remove("Error"),!a}()){this.setState((function(){return{submitting:!0}}));var a=new FormData;a.append("passport",t.passport),a.append("firstName",t.firstName),a.append("lastName",t.lastName),a.append("email",t.email),a.append("password",t.password),a.append("gender",t.gender),a.append("jobRole",t.jobRole),a.append("department",t.department),a.append("address",t.address),this.fetchRequest({url:"https://akintomiwa-capstone-backend.herokuapp.com/api/v1/auth/create-user",method:"POST",body:a}).then((function(){e._isMounted&&(e.resetForm(),b.popMessage("user account created successfully"))})).catch((function(t){t.body.email?(A("#regForm .form-element[name=email]").classList.add("Error"),e.setState((function(){return{emailError:"email invalid or already exist"}})),b.popMessage("Opps!, couldn't create user account ")):b.popMessage("Opps!, couldn't complete your request please try again")})).finally((function(){e._isMounted&&e.setState((function(){return{submitting:!1}}))}))}else b.popMessage("Please complete the form before submitting")}}},{key:"render",value:function(){if(!this.props.sessionUser.isAdmin)return r.a.createElement(F,null);var e=[],t=this.state.departments,a=Object.keys(t);a.forEach((function(a){e.push(r.a.createElement("option",{value:a,key:a},t[a].name))}));var n=[],s=this.state.department;-1!==a.indexOf(s)&&t[s].jobRoles.forEach((function(e){n.push(r.a.createElement("option",{value:e.id,key:e.id},e.title))}));return r.a.createElement("div",{id:"regForm"},r.a.createElement("h2",{id:"regFormLabel"},"Create a new user account"),r.a.createElement("div",{id:"regDisplay",onClick:function(){A("#regPassportPicker").click()}},r.a.createElement("img",{id:"regPassport",alt:""}),r.a.createElement("div",{className:"overlay"},r.a.createElement("p",{className:"far fa-image"}),r.a.createElement("p",null,"pick passport")),r.a.createElement("input",{type:"file",className:"form-element",name:"passport",id:"regPassportPicker",accept:"image/jpeg,image/jpg",onChange:this.onDisplayChange})),r.a.createElement("div",{className:"input-group"},r.a.createElement("p",{className:"form-label"},"first name"),r.a.createElement("input",{type:"text",name:"firstName",value:this.state.firstName,className:"form-element",placeholder:"user first name",onChange:this.regInputsState})),r.a.createElement("div",{className:"input-group"},r.a.createElement("p",{className:"form-label"},"last name"),r.a.createElement("input",{type:"text",name:"lastName",value:this.state.lastName,className:"form-element",placeholder:"user last name",onChange:this.regInputsState})),r.a.createElement("div",{className:"input-group"},r.a.createElement("p",{className:"form-label"},"email"),r.a.createElement("input",{type:"text",name:"email",value:this.state.email,className:"form-element",placeholder:"user email address",onChange:this.regInputsState}),r.a.createElement("p",{className:"error-msg ".concat(""===this.state.emailError?"hide":"")},this.state.emailError)),r.a.createElement("div",{className:"input-group"},r.a.createElement("p",{className:"form-label"},"password"),r.a.createElement("input",{type:"password",name:"password",value:this.state.password,className:"form-element",placeholder:"user password",onChange:this.regInputsState}),r.a.createElement("p",{className:"error-msg ".concat(""===this.state.passwordError?"hide":"")},this.state.passwordError)),r.a.createElement("div",{className:"input-group"},r.a.createElement("p",{className:"form-label"},"gender"),r.a.createElement("select",{className:"form-element ".concat(b.isEmpty(this.state.gender)?"placeholder":""),name:"gender",value:b.isEmpty(this.state.gender)?"-placeholder-":this.state.gender,onChange:this.onGenderChange},r.a.createElement("option",{value:"-placeholder-",disabled:!0},"user gender"),r.a.createElement("option",{value:"male"},"male"),r.a.createElement("option",{value:"female"},"female"))),r.a.createElement("div",{className:"input-group"},r.a.createElement("p",{className:"form-label"},"department"),r.a.createElement("select",{className:"form-element ".concat(b.isEmpty(this.state.department)?"placeholder":""),value:b.isEmpty(this.state.department)?"-placeholder-":this.state.department,name:"department",onChange:this.onDepartmentChange},r.a.createElement("option",{value:"-placeholder-",disabled:!0},"user department"),e)),r.a.createElement("div",{className:"input-group"},r.a.createElement("p",{className:"form-label"},"job role"),r.a.createElement("select",{className:"form-element ".concat(b.isEmpty(this.state.jobRole)?"placeholder":""),value:b.isEmpty(this.state.jobRole)?"-placeholder-":this.state.jobRole,name:"jobRole",onChange:this.onJobRoleChange},r.a.createElement("option",{value:"-placeholder-",disabled:!0},"user job role"),n)),r.a.createElement("div",{className:"input-group"},r.a.createElement("p",{className:"form-label"},"address"),r.a.createElement("input",{type:"text",name:"address",value:this.state.address,className:"form-element",placeholder:"user home address",onChange:this.regInputsState})),r.a.createElement("button",{type:"submit",className:"btn btn-success ".concat(this.state.submitting?"disabled":""),onClick:this.createUser},r.a.createElement("span",{className:"fas fa-user-plus icon"}),"create user"))}}]),t}(r.a.Component),L=(a(17),a(26)),q=(a(45),a(46),{comment:"",isfocused:!1,submitting:!1}),x=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state=q,a.onCommentInput=a.onCommentInput.bind(Object(h.a)(a)),a.onFocus=a.onFocus.bind(Object(h.a)(a)),a.onFocus=a.onFocus.bind(Object(h.a)(a)),a.onBlur=a.onBlur.bind(Object(h.a)(a)),a.submitComment=a.submitComment.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"onCommentInput",value:function(e){var t=e.target.value;this.setState((function(){return{comment:t}}))}},{key:"onFocus",value:function(){this.setState((function(){return{isfocused:!0}}))}},{key:"onBlur",value:function(){this.setState((function(){return{isfocused:!1}}))}},{key:"submitComment",value:function(){var e=this;if(!b.isEmpty(this.state.comment)){this.setState((function(){return{submitting:!0}}));var t=this.props.post,a=this.props.fetchRequest,n="gif"===t.type?"gifs":"articles";a({url:"https://akintomiwa-capstone-backend.herokuapp.com/api/v1/".concat(n,"/").concat(t.id,"/comment"),method:"POST",body:'{\n          "comment":"'.concat(this.state.comment,'"\n        }'),headers:{"Content-Type":"application/json"}}).then((function(t){e.setState((function(){return q})),e.props.post.comments&&e.props.registerComment({authorId:e.props.sessionUser.id,comment:t.comment,commentId:t.commentId,createdOn:t.createdOn}),b.popMessage("Comment created successfully")})).catch((function(t){404===t.status?(e.props.history.push("/"),b.popMessage("Post not found!")):b.popMessage("we were unable create your comment please try again")})).finally((function(){e.setState((function(){return{submitting:!1}}))}))}}},{key:"render",value:function(){return r.a.createElement("div",{className:"add-comment ".concat(this.state.submitting?"disabled":"")},r.a.createElement("div",{className:"user-image"},r.a.createElement("a",{href:"/"},r.a.createElement("img",{src:this.props.sessionUser.passportUrl,alt:"".concat(this.props.sessionUser.firstName," ").concat(this.props.sessionUser.lastName)}))),r.a.createElement("div",{className:"comment-input ".concat(this.state.isfocused?"focused":"")},r.a.createElement("input",{type:"text",className:"comment form-element",placeholder:"input comment here",value:this.state.comment,onChange:this.onCommentInput,onFocus:this.onFocus,onBlur:this.onBlur}),r.a.createElement("span",{className:"fas ".concat(this.state.submitting?"fa-spinner fa-spin":"fa-paper-plane"," icon submit-comment"),onClick:this.submitComment})))}}]),t}(r.a.Component),B=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).moreActions=null,a.focusMoreActions=a.focusMoreActions.bind(Object(h.a)(a)),a.blurMoreActions=a.blurMoreActions.bind(Object(h.a)(a)),a.revealReportDialog=a.revealReportDialog.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.showMoreActions&&this.moreActions.focus()}},{key:"focusMoreActions",value:function(e){this.moreActions=e,e&&e.focus()}},{key:"blurMoreActions",value:function(e){e.target.blur(),this.props.hideMoreActions()}},{key:"revealReportDialog",value:function(e){e.stopPropagation(),this.moreActions.blur(),this.props.focusForReport(),this.props.showReportDialog()}},{key:"render",value:function(){var e=this.props.showMoreActions,t=this.props.moreActionEl;if(!e||!t)return r.a.createElement("div",null);var a=b.getCordinates(t),n=t.offsetWidth;return r.a.createElement("button",{type:"button",className:"more-actions-dialog",ref:this.focusMoreActions,onBlur:this.blurMoreActions,style:{top:"".concat(a.top,"px"),left:"".concat(a.left+n,"px")}},r.a.createElement("span",{className:"action",onClick:this.revealReportDialog},r.a.createElement("span",{className:"fas fa-flag-checkered icon"}),"report"))}}]),t}(r.a.Component);B.defaultProps={moreActionEl:!1};var G=B,V=(a(47),["inappropriate","abusive","bullying","scam","misleading"]),W=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={reporting:!1,flag:"inappropriate",flagError:!1,reason:"",reasonError:!1},a._isMounted=!1,a.hideReportDialog=a.hideReportDialog.bind(Object(h.a)(a)),a.preventHide=a.preventHide.bind(Object(h.a)(a)),a.regInputsState=a.regInputsState.bind(Object(h.a)(a)),a.submitReport=a.submitReport.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"preventHide",value:function(e){e.stopPropagation()}},{key:"hideReportDialog",value:function(e){e&&e.stopPropagation(),this.props.hideReportDialog()}},{key:"regInputsState",value:function(e){var t=e.target.name,a=e.target.value;this.setState((function(){var e={};return e[t]=a,e}))}},{key:"submitReport",value:function(){var e=this,t=this.state,a=!0;if(-1===V.indexOf(t.flag)?(this.setState((function(){return{flagError:!0}})),a=!1):this.setState((function(){return{flagError:!1}})),b.isEmpty(t.reason)?(this.setState((function(){return{reasonError:!0}})),a=!1):this.setState((function(){return{reasonError:!1}})),a&&!this.state.reporting){this.setState((function(){return{reporting:!0}}));var n=this.props.content,r="";if(-1!==["gif","article"].indexOf(n.type))r="https://akintomiwa-capstone-backend.herokuapp.com/api/v1/".concat(n.type,"s/").concat(n.id,"/flag");else{var s=this.props.post;r="https://akintomiwa-capstone-backend.herokuapp.com/api/v1/".concat(s.type,"s/").concat(s.id,"/comment/").concat(n.commentId,"/flag")}this.props.fetchRequest({url:r,method:"post",body:'{\n          "flag": "'.concat(t.flag,'",\n          "reason": "').concat(t.reason,'"\n        }'),headers:{"Content-Type":"application/json"}}).then((function(){b.popMessage("report created successfully"),e._isMounted&&e.hideReportDialog()})).catch((function(){e._isMounted&&(e.setState((function(){return{reporting:!1}})),b.popMessage("sorry, we were unable to complete your request please try again"))}))}}},{key:"render",value:function(){var e=this.props.content,t=this.state.flagError?r.a.createElement("p",{className:"error"},"pick a flag"):"",a=this.state.reasonError?r.a.createElement("p",{className:"error"},"please state why you are flagging this ",e.type):"",n=[];return V.forEach((function(e){n.push(r.a.createElement("option",{value:e,key:e},e))})),r.a.createElement("div",{id:"contentReportDialog",onClick:this.hideReportDialog},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"form content",onClick:this.preventHide},r.a.createElement("span",{className:"cancel fas fa-times",onClick:this.hideReportDialog}),r.a.createElement("h1",{className:"header"},"create a report on this ",e.type),r.a.createElement("div",{className:"field"},r.a.createElement("span",{className:"form-label"},"flag as"),r.a.createElement("select",{className:"form-element",name:"flag",value:this.state.flag,onChange:this.regInputsState},n),t),r.a.createElement("div",{className:"field"},r.a.createElement("span",{className:"form-label"},"reason"),r.a.createElement("textarea",{className:"form-element",name:"reason",value:this.state.reason,onChange:this.regInputsState}),a),r.a.createElement("button",{type:"submit",className:"btn btn-danger".concat(this.state.reporting?" disabled":""),onClick:this.submitReport},r.a.createElement("span",{className:"fas fa-flag-checkered icon"}),"submit report"))))}}]),t}(r.a.Component);function H(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function z(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?H(a,!0).forEach((function(t){Object(f.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):H(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var J=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={comment:z({},e.comment,{author:!1}),dateTimeRef:b.getRelativeTime(e.comment.createdOn),showMoreActions:!1,reportFocused:!1,showReportDialog:!1},a._isMounted=!1,a.moreActionEl=null,a.updateCommentDatetimeRef=null,a.showMoreActions=a.showMoreActions.bind(Object(h.a)(a)),a.hideMoreActions=a.hideMoreActions.bind(Object(h.a)(a)),a.focusForReport=a.focusForReport.bind(Object(h.a)(a)),a.showReportDialog=a.showReportDialog.bind(Object(h.a)(a)),a.showReportDialog=a.showReportDialog.bind(Object(h.a)(a)),a.hideReportDialog=a.hideReportDialog.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,this.props.getUser("".concat(this.state.comment.authorId)).then((function(t){e._isMounted&&(e.setState((function(e){return{comment:z({},e.comment,{author:t})}})),e.updateCommentDatetimeRef=setInterval((function(){e._isMounted&&e.setState((function(e){return{dateTimeRef:b.getRelativeTime(e.comment.createdOn)}}))}),6e4))}))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,clearInterval(this.updateCommentDatetimeRef)}},{key:"showMoreActions",value:function(){this.setState((function(){return{showMoreActions:!0}}))}},{key:"hideMoreActions",value:function(){this.setState((function(){return{showMoreActions:!1}}))}},{key:"focusForReport",value:function(){this.setState((function(){return{reportFocused:!0}}))}},{key:"showReportDialog",value:function(){this.setState((function(){return{showReportDialog:!0}}))}},{key:"hideReportDialog",value:function(){this.setState((function(){return{showReportDialog:!1,reportFocused:!1}}))}},{key:"render",value:function(){var e=this,t=this.state.comment,a=this.state.reportFocused?" report-focused":"",n=this.state.showReportDialog?r.a.createElement(W,Object.assign({},this.props,{content:z({},t,{type:"comment"}),hideReportDialog:this.hideReportDialog})):"";return!1!==t.author?r.a.createElement("div",{className:"post-comment".concat(a),id:t.commentId},r.a.createElement("div",null,r.a.createElement("div",{className:"user-image"},r.a.createElement("a",{href:"/"},r.a.createElement("img",{src:t.author.passportUrl,alt:"".concat(t.author.firstName," ").concat(t.author.lastName)}))),r.a.createElement("div",{className:"comment-details-container"},r.a.createElement("div",{className:"comment-details"},r.a.createElement("div",null,r.a.createElement("span",{className:"author-name"},"".concat(t.author.firstName," ").concat(t.author.lastName)),r.a.createElement("span",{className:"content"},t.comment)),r.a.createElement("span",{className:"more-action",onClick:this.showMoreActions,ref:function(t){e.moreActionEl=t}},r.a.createElement("span",null,"\u2022"),r.a.createElement("span",null,"\u2022"),r.a.createElement("span",null,"\u2022")),r.a.createElement(G,Object.assign({},this.props,{comment:t,showMoreActions:this.state.showMoreActions,hideMoreActions:this.hideMoreActions,focusForReport:this.focusForReport,showReportDialog:this.showReportDialog,moreActionEl:this.moreActionEl}))))),r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("span",{title:b.getRelativeTime(t.createdOn,!1)},this.state.dateTimeRef))),n):r.a.createElement("div",null)}}]),t}(r.a.Component),K=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).moreActions=null,a.editPost=a.editPost.bind(Object(h.a)(a)),a.focusMoreActions=a.focusMoreActions.bind(Object(h.a)(a)),a.blurMoreActions=a.blurMoreActions.bind(Object(h.a)(a)),a.promptDelete=a.promptDelete.bind(Object(h.a)(a)),a.revealReportDialog=a.revealReportDialog.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.showMoreActions&&this.moreActions.focus()}},{key:"editPost",value:function(e){e.stopPropagation();var t=this.props.post;this.props.history.push("/post/".concat(t.type,"/").concat(t.id,"/edit"))}},{key:"focusMoreActions",value:function(e){this.moreActions=e,e&&e.focus()}},{key:"blurMoreActions",value:function(e){e.target.blur(),this.props.hideMoreActions()}},{key:"promptDelete",value:function(e){e.stopPropagation(),this.props.promptDelete(),this.moreActions.blur(),this.props.hideMoreActions()}},{key:"revealReportDialog",value:function(e){e.stopPropagation(),this.moreActions.blur(),this.props.focusForReport(),this.props.showReportDialog()}},{key:"render",value:function(){if(!this.props.showMoreActions)return r.a.createElement("div",null);var e="",t="";return this.props.post.authorId===this.props.sessionUser.id&&(e=r.a.createElement("span",{className:"action",onClick:this.editPost},r.a.createElement("span",{className:"fas fa-pencil-alt icon"}),"edit"),t=r.a.createElement("span",{className:"action",onClick:this.promptDelete},r.a.createElement("span",{className:"fa fa-trash icon"}),"delete")),r.a.createElement("button",{type:"button",className:"more-actions-dialog",ref:this.focusMoreActions,onBlur:this.blurMoreActions},e,r.a.createElement("span",{className:"action",onClick:this.revealReportDialog},r.a.createElement("span",{className:"fas fa-flag-checkered icon"}),"report"),t)}}]),t}(r.a.Component);function Y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function $(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Y(a,!0).forEach((function(t){Object(f.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Y(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Q=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={post:$({},a.props.post,{author:null}),dateTimeRef:"",showMoreActions:!1,promptDelete:!1,deleting:!1,showReportDialog:!1,reportFocused:!1},a._isMounted=!1,a.updatePostDateTimeRef=null,a.getAuthor=a.getAuthor.bind(Object(h.a)(a)),a.viewPost=a.viewPost.bind(Object(h.a)(a)),a.registerComment=a.registerComment.bind(Object(h.a)(a)),a.showMoreActions=a.showMoreActions.bind(Object(h.a)(a)),a.hideMoreActions=a.hideMoreActions.bind(Object(h.a)(a)),a.promptDelete=a.promptDelete.bind(Object(h.a)(a)),a.removeDeleteDialog=a.removeDeleteDialog.bind(Object(h.a)(a)),a.deletePost=a.deletePost.bind(Object(h.a)(a)),a.showReportDialog=a.showReportDialog.bind(Object(h.a)(a)),a.hideReportDialog=a.hideReportDialog.bind(Object(h.a)(a)),a.focusForReport=a.focusForReport.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,!0===this.props.preview&&this.props.pageSwitch("post",!0),this.getAuthor().then((function(){e.updatePostDateTimeRef=setInterval((function(){e._isMounted&&e.setState((function(e){return{dateTimeRef:b.getRelativeTime(e.post.createdOn)}}))}),6e4),e.state.post.isNew&&!0===e.state.post.isNew&&setTimeout((function(){e._isMounted&&e.setState((function(e){return{post:$({},e.post,{isNew:!1})}}))}),5e3)}))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,clearInterval(this.updatePostDateTimeRef)}},{key:"getAuthor",value:function(){var e=this;return new Promise((function(t){e.props.getUser("".concat(e.state.post.authorId)).then((function(a){e._isMounted&&(e.setState((function(e){return{post:$({},e.post,{author:a}),dateTimeRef:b.getRelativeTime(e.post.createdOn)}})),t())}))}))}},{key:"registerComment",value:function(e){this.setState((function(t){return{post:$({},t.post,{comments:[].concat(Object(L.a)(t.post.comments),[e])})}}))}},{key:"viewPost",value:function(){var e=this.props.getCurrentPage,t=this.state.post;"post"!==e()&&this.props.history.push("/post/".concat(t.type,"/").concat(t.id))}},{key:"showMoreActions",value:function(e){e.stopPropagation(),this.setState((function(){return{showMoreActions:!0}}))}},{key:"hideMoreActions",value:function(){this.setState((function(){return{showMoreActions:!1}}))}},{key:"promptDelete",value:function(){this.setState((function(){return{promptDelete:!0}}))}},{key:"removeDeleteDialog",value:function(){this.setState((function(){return{promptDelete:!1}}))}},{key:"deletePost",value:function(){var e=this,t=this.state.post;if(!this.state.deleting){this.setState((function(){return{deleting:!0}}));var a=this.props.fetchRequest,n=function(a){setTimeout((function(){e._isMounted&&e.props.onDelete(t)}),a)};a({url:"https://akintomiwa-capstone-backend.herokuapp.com/api/v1/".concat(t.type,"s/").concat(t.id),method:"delete"}).then((function(){var t=0;e.props.preview||(t=500,e.setState((function(e){return{post:$({},e.post,{willDelete:!0})}}))),n(t)})).catch((function(){b.popMessage("sorry, we couldn't comploete your request pleas try again")}))}}},{key:"showReportDialog",value:function(){this.setState((function(){return{showReportDialog:!0}}))}},{key:"hideReportDialog",value:function(){this.setState((function(){return{showReportDialog:!1,reportFocused:!1}}))}},{key:"focusForReport",value:function(){this.setState((function(){return{reportFocused:!0}}))}},{key:"render",value:function(){var e=null;if("post"===this.props.getCurrentPage()){var t=this.state.post.comments;e=[];for(var a=0;a<t.length;a+=1)e.push(r.a.createElement(J,Object.assign({},this.props,{comment:t[a],key:t[a].commentId})))}else e=r.a.createElement("button",{type:"button",className:"view-comment",title:"view comments"},r.a.createElement("span",{className:"far fa-comment-dots icon"}),"comments");var n=this.state.post;if(null!==n.author){var s=this.state,o="gif"===n.type?r.a.createElement("img",{className:"item",src:n.url,alt:n.title}):r.a.createElement("div",{className:"item"},n.article),i=s.promptDelete?r.a.createElement("div",{className:"prompt"},r.a.createElement("div",{className:"prompt-bk"}),r.a.createElement("div",{className:"prompt-fk"},r.a.createElement("p",null,"are you sure you want to delete this post?"),r.a.createElement("div",{className:"actions"},r.a.createElement("button",{type:"submit",className:"btn btn-danger",onClick:this.deletePost},"yes"),r.a.createElement("button",{type:"submit",className:"btn btn-negative",onClick:this.removeDeleteDialog},"no")))):"",c=s.showReportDialog?r.a.createElement(W,Object.assign({},this.props,{content:this.props.post,hideReportDialog:this.hideReportDialog})):"",l=n.isNew&&!0===n.isNew?" new":"",u=this.props.preview?" view":"",p=n.willDelete?" remove":"",m=this.state.deleting?" deleting":"",d=this.state.reportFocused?" report-focused":"";return r.a.createElement("div",{className:"post".concat(l).concat(u).concat(p).concat(m).concat(d)},r.a.createElement("div",{onClick:this.viewPost},r.a.createElement("div",{className:"head"},r.a.createElement("div",{className:"user-image"},r.a.createElement("a",{href:"/"},r.a.createElement("img",{src:n.author.passportUrl,alt:"".concat(n.author.firstName," ").concat(n.author.lastName)}))),r.a.createElement("div",null,r.a.createElement("a",{href:"/",className:"user-name",title:""},"".concat(n.author.firstName," ").concat(n.author.lastName)),r.a.createElement("p",{className:"date-time","data-timestamp":n.createdOn,title:b.getRelativeTime(n.createdOn,!1)},this.state.dateTimeRef)),r.a.createElement("button",{type:"button",className:"more-action",onClick:this.showMoreActions},r.a.createElement("span",null,"\u2022"),r.a.createElement("span",null,"\u2022"),r.a.createElement("span",null,"\u2022")),r.a.createElement(K,Object.assign({},this.props,{showMoreActions:this.state.showMoreActions,hideMoreActions:this.hideMoreActions,promptDelete:this.promptDelete,showReportDialog:this.showReportDialog,focusForReport:this.focusForReport}))),r.a.createElement("div",{className:"body"},r.a.createElement("div",{className:"title"},n.title),r.a.createElement("div",{className:"content"},o)),e),r.a.createElement(x,Object.assign({},this.props,{registerComment:this.registerComment})),i,c)}return r.a.createElement("div",null)}}]),t}(r.a.Component);Q.defaultProps={preview:!1};var X=Q,Z=(a(48),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={loading:!0},a._isMounted=!1,a.onDelete=a.onDelete.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0;var t=function(t){!0===e._isMounted&&(e.props.setPosts(t),e.setState((function(){return{loading:!1}})))};(0,this.props.fetchRequest)({url:"https://akintomiwa-capstone-backend.herokuapp.com/api/v1/feeds"}).then((function(e){t(e)})).catch((function(){t([])}))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"onDelete",value:function(e){this.props.deletePost(e)}},{key:"render",value:function(){for(var e=[],t=this.props.getPosts(),a=0;a<t.length;a+=1)e.push(r.a.createElement(X,Object.assign({},this.props,{post:t[a],key:t[a].id,onDelete:this.onDelete})));return this.state.loading||0!==e.length?r.a.createElement("div",{id:"posts",className:this.state.loading?"loading":""},e):r.a.createElement("div",{className:"empty-posts-tab"},r.a.createElement("span",null," there are no posts to show "))}}]),t}(r.a.Component));a(49);function ee(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function te(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ee(a,!0).forEach((function(t){Object(f.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ee(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ae={type:"gif",title:"",image:null},ne={type:"article",title:"",article:""},re=function(e){return document.querySelector(e)},se=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={submitting:!1,focused:!1,post:ne},a._isMounted=!1,a.onInputFocus=a.onInputFocus.bind(Object(h.a)(a)),a.onInputChange=a.onInputChange.bind(Object(h.a)(a)),a.onInputBlur=a.onInputBlur.bind(Object(h.a)(a)),a.onGifChange=a.onGifChange.bind(Object(h.a)(a)),a.submitPost=a.submitPost.bind(Object(h.a)(a)),a.onGifDrop=a.onGifDrop.bind(Object(h.a)(a)),a.changePostType=a.changePostType.bind(Object(h.a)(a)),a.onArticleChange=a.onArticleChange.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"onInputFocus",value:function(){this.setState((function(){return{focused:!0}}))}},{key:"onInputChange",value:function(e){var t=e.target.name;if(-1!==Object.keys(this.state.post).indexOf(t)){var a=e.target.value;this.setState((function(e){var n={};return n[t]=a,{post:te({},e.post,{},n)}})),b.isEmpty(a)||e.target.classList.remove("Error")}}},{key:"onInputBlur",value:function(){this.setState((function(){return{focused:!1}}))}},{key:"onGifChange",value:function(e){var t=this,a=e.target,n=re("#postGifBlock"),r=a.files[0];if(r&&"image/gif"===r.type)if(r.size>10485760)b.popMessage("can't upload image larger than 10mb");else{var s=new FileReader;s.readAsDataURL(r),s.onerror=function(){b.popMessage("Oops!, we couldn't attach the file picked please try again or try another one")},s.onload=function(e){var a=e.target.result;re("#postGif").src=a,n.classList.remove("Error"),t._isMounted&&t.setState((function(e){return{post:te({},e.post,{image:r})}}))}}else b.popMessage("Image as to be a GIF (.gif) file")}},{key:"onGifDragLeave",value:function(){re("#postGifBlock").classList.remove("drag-over")}},{key:"onGifDragOver",value:function(e){e.stopPropagation(),e.preventDefault(),re("#postGifBlock").classList.add("drag-over")}},{key:"onGifDrop",value:function(e){var t=this;e.preventDefault();var a=function(e){if("file"===e.kind){var a={target:{files:[e.getAsFile()]}};t.onGifChange(a)}};e.dataTransfer.items?a(e.dataTransfer.items[0]):a(e.dataTransfer.files[0])}},{key:"onArticleChange",value:function(e){var t=e.target.value;this.setState((function(e){return{post:te({},e.post,{article:t})}})),b.isEmpty(t)||e.target.classList.remove("Error")}},{key:"changePostType",value:function(e,t){var a="gif"===t?ae:ne;this.setState((function(){return{post:a}}))}},{key:"resetForm",value:function(){var e="gif"===this.state.post.type?ae:ne;this.setState((function(){return{post:e}})),"gif"===e.type&&(re("#postGif").src="",re("#gifPicker").value=null)}},{key:"submitPost",value:function(){var e=this;if(!1===this.state.submitting){var t=this.state.post;if(function(){var e=!1;return b.isEmpty(t.title)?(re("#sharePost .content .form-element[name=title]").classList.add("Error"),e=!0):re("#sharePost .content .form-element[name=title]").classList.remove("Error"),"gif"===t.type?null===t.image?(re("#postGifBlock").classList.add("Error"),e=!0):re("#postGifBlock").classList.remove("Error"):b.isEmpty(t.article)?(re("#sharePost .content .form-element[name=article]").classList.add("Error"),e=!0):re("#sharePost .content .form-element[name=article]").classList.remove("Error"),!e}()){this.setState((function(){return{submitting:!0}}));var a=null,n="",r=!1;"gif"===t.type?((a=new FormData).append("title",t.title),a.append("image",t.image),n="https://akintomiwa-capstone-backend.herokuapp.com/api/v1/gifs"):(a='{\n            "title":"'.concat(t.title,'",\n            "article":"').concat(t.article,'"\n          }'),n="https://akintomiwa-capstone-backend.herokuapp.com/api/v1/articles",r="application/json");var s={Authorization:"Bearer ".concat(localStorage.getItem("sessionUserToken"))};!1!==r&&(s["Content-Type"]=r),(0,this.props.fetchRequest)({url:n,method:"POST",body:a,headers:s}).then((function(a){e.resetForm(),b.popMessage("post created successfully"),e.props.registerPost(te({},a,{type:t.type}))})).catch((function(e){"error"===e.status&&"gif"===t.type&&(re("#postGifBlock").classList.add("Error"),b.popMessage("invalid image uploaded please retry with a .gif file"))})).finally((function(){e._isMounted&&e.setState((function(){return{submitting:!1}}))}))}else b.popMessage("Please complete the form before submitting")}}},{key:"render",value:function(){var e=this,t=null,a=this.state.post;return t="gif"===a.type?r.a.createElement("div",{id:"postGifContainer"},r.a.createElement("input",{type:"text",className:"form-element",name:"title",value:a.title,placeholder:"gif title",onFocus:this.onInputFocus,onChange:this.onInputChange,onBlur:this.onInputBlur}),r.a.createElement("div",{id:"postGifBlock",className:null!==a.image?"selected":"",onClick:function(){re("#gifPicker").click()}},r.a.createElement("img",{id:"postGif",alt:"post gif",src:""}),r.a.createElement("div",{className:"bk"},r.a.createElement("span",{className:"fa fa-image icon"}),r.a.createElement("p",null,"click to pick a gif image or drag and drop it here")),r.a.createElement("div",{className:"overlay"},r.a.createElement("p",null,"Drop it like it's hot!"),r.a.createElement("div",{className:"drop-container",onDrop:this.onGifDrop,onDragOver:this.onGifDragOver,onDragLeave:this.onGifDragLeave})),r.a.createElement("input",{type:"file",className:"form-element",name:"postGif",id:"gifPicker",accept:"image/gif",onChange:this.onGifChange}))):r.a.createElement("div",{id:"postArticleContainer"},r.a.createElement("input",{type:"text",className:"form-element",name:"title",value:a.title,placeholder:"article title",onFocus:this.onInputFocus,onChange:this.onInputChange,onBlur:this.onInputBlur}),r.a.createElement("textarea",{id:"postArticleBlock",className:"form-element",name:"article",value:a.article,placeholder:"article",onFocus:this.onInputFocus,onChange:this.onInputChange,onBlur:this.onInputBlur})),r.a.createElement("div",{id:"sharePost",className:this.state.focused?"focused":""},r.a.createElement("div",{className:"head"},r.a.createElement("h2",{className:"label"},"share a post"),r.a.createElement("span",{className:"icon ".concat("gif"===a.type?"fa fa-image":"fa fa-newspaper")})),r.a.createElement("div",{className:"content"},t),r.a.createElement("div",{className:"bottom"},r.a.createElement("div",{className:"post-types"},r.a.createElement("button",{type:"button",className:"post-type ".concat("article"===a.type?"active":""),onClick:function(t){e.changePostType(t,"article")}},"article"),r.a.createElement("button",{type:"button",className:"post-type ".concat("gif"===a.type?"active":""),onClick:function(t){e.changePostType(t,"gif")}},"gif")),r.a.createElement("button",{type:"submit",className:this.state.submitting?"disabled":"",onClick:this.submitPost},r.a.createElement("span",null,r.a.createElement("span",{className:"fk"},r.a.createElement("span",null,"post "),r.a.createElement("span",{className:"fas ".concat(this.state.submitting?"fa-spinner fa-spin":"fa-paper-plane"," icon")}))))))}}]),t}(r.a.Component);function oe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var ie=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={posts:[]},a._isMounted=!1,a.setPosts=a.setPosts.bind(Object(h.a)(a)),a.registerPost=a.registerPost.bind(Object(h.a)(a)),a.getPosts=a.getPosts.bind(Object(h.a)(a)),a.deletePost=a.deletePost.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0,this.props.pageSwitch("feeds")}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"setPosts",value:function(e){this.setState((function(){return{posts:e}}))}},{key:"getPosts",value:function(){return this.state.posts}},{key:"registerPost",value:function(e){var t=this;this.props.getPost(e).then((function(a){t._isMounted&&t.setState((function(t){var n=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?oe(a,!0).forEach((function(t){Object(f.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):oe(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},a,{type:e.type,isNew:!0}),r=t.posts;return r.unshift(n),{posts:r}}))})).catch((function(e){"Unauthorized"===e?t.props.history.push("/signin"):(b.popMessage(navigator.onLine?"can't connect to serve because you are offline, will retry in 5 seconds":"oops! there was a server error"),setTimeout((function(){b.popMessage("retrying to connect to server"),t._isMounted&&t.registerPost()}),5e3))}))}},{key:"deletePost",value:function(e){for(var t=this.state.posts,a=[],n=0;n<t.length;n+=1)t[n].id!==e.id&&a.push(t[n]);this.setState((function(){return{posts:a}})),b.popMessage("".concat(e.type," deleted successfully"))}},{key:"render",value:function(){return r.a.createElement("div",{id:"feedPosts"},r.a.createElement(se,Object.assign({},this.props,{registerPost:this.registerPost})),r.a.createElement(Z,Object.assign({},this.props,{setPosts:this.setPosts,getPosts:this.getPosts,deletePost:this.deletePost})))}}]),t}(r.a.Component),ce=(a(50),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={submitting:!1,author:null,dateTimeRef:"",title:a.props.post.title,titleError:!1,articleError:!1,article:"",isOwner:!1},a._isMounted=!1,a.updatePostDateTimeRef=null,a.getAuthor=a.getAuthor.bind(Object(h.a)(a)),a.regInputsState=a.regInputsState.bind(Object(h.a)(a)),a.updatePost=a.updatePost.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,this.props.pageSwitch("edit post",!0);var t=this.props.post;t.authorId===this.props.sessionUser.id&&(this.setState((function(){return{isOwner:!0}})),this.getAuthor().then((function(){e.updatePostDateTimeRef=setInterval((function(){e._isMounted&&e.setState((function(){return{dateTimeRef:b.getRelativeTime(t.createdOn)}}))}),6e4)})),"article"===t.type&&this.setState((function(){return{article:t.article}})))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,clearInterval(this.updatePostDateTimeRef)}},{key:"getAuthor",value:function(){var e=this;return new Promise((function(t){var a=e.props.post;e.props.getUser("".concat(a.authorId)).then((function(n){e._isMounted&&(e.setState((function(){return{author:n,dateTimeRef:b.getRelativeTime(a.createdOn)}})),t())}))}))}},{key:"regInputsState",value:function(e){var t=e.target.name,a=e.target.value;this.setState((function(){var e={};return e[t]=a,e}))}},{key:"updatePost",value:function(){var e=this,t=this.state;if(!t.submitting){var a=!0;b.isEmpty(t.title)?(this.setState((function(){return{titleError:!0}})),a=!1):this.setState((function(){return{titleError:!1}}));var n=this.props.post.type,r=this.props.post.id;if("article"===n&&(b.isEmpty(t.article)?(this.setState((function(){return{articleError:!0}})),a=!1):this.setState((function(){return{articleError:!1}}))),a){this.setState((function(){return{submitting:!0}}));var s={title:t.title};"article"===n&&(s.article=t.article),this.props.fetchRequest({url:"https://akintomiwa-capstone-backend.herokuapp.com/api/v1/".concat(n,"s/").concat(r),method:"patch",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}}).then((function(){if(e._isMounted){b.popMessage("post updated successfully");var t=e.props.history;t.length>2?t.goBack():t.push("/feed")}})).catch((function(){b.popMessage("there was an error proccessing your request, please try again")}))}else b.popMessage("please complete the form before submitting")}}},{key:"render",value:function(){if(!this.state.isOwner)return r.a.createElement(F,this.props);var e=this.props.post,t=this.state.author;if(null!==t){var a="gif"===e.type?r.a.createElement("img",{className:"item",src:e.url,alt:""}):r.a.createElement("textarea",{className:"form-element  ".concat(this.state.articleError?"Error":""),name:"article",value:this.state.article,onChange:this.regInputsState});return r.a.createElement("div",{id:"postEdit"},r.a.createElement("div",{className:"post",id:e.id},r.a.createElement("div",{onClick:this.viewPost},r.a.createElement("div",{className:"head"},r.a.createElement("div",{className:"user-image"},r.a.createElement("a",{href:"/"},r.a.createElement("img",{src:t.passportUrl,alt:"".concat(t.firstName," ").concat(t.lastName)}))),r.a.createElement("div",null,r.a.createElement("a",{href:"/",className:"user-name",title:""},"".concat(t.firstName," ").concat(t.lastName)),r.a.createElement("p",{className:"date-time","data-timestamp":e.createdOn,title:b.getRelativeTime(e.createdOn,!1)},this.state.dateTimeRef))),r.a.createElement("div",{className:"body"},r.a.createElement("input",{className:"title form-element ".concat(this.state.titleError?"Error":""),name:"title",value:this.state.title,placeholder:"title",onChange:this.regInputsState}),r.a.createElement("div",{className:"content"},a)))),r.a.createElement("button",{type:"submit",className:"btn btn-default ".concat(this.state.submitting?"disabled":""),onClick:this.updatePost},r.a.createElement("span",{className:"icon ".concat(this.state.submitting?"fa fa-spinner fa-spin":"fas fa-save")}),"save"))}return r.a.createElement("div",null,r.a.createElement("span",{className:"fa fa-spinner fa-spin loader"}))}}]),t}(r.a.Component));function le(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ue(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?le(a,!0).forEach((function(t){Object(f.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):le(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var pe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={post:!1},a._isMounted=!1,a.onDelete=a.onDelete.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0;var t={type:this.props.match.params.type};"gif"===t.type?t.gifId=this.props.match.params.id:"article"===t.type?t.articleId=this.props.match.params.id:(t=!1,this.setState((function(){return{post:null}}))),t&&this.props.getPost(t).then((function(t){e._isMounted&&e.setState((function(){return{post:t}}))})).catch((function(t){e._isMounted&&(404===t.status?e.setState((function(){return{post:null}})):(e.props.history.push("/"),b.popMessage("sorry we couldn't complete your request please try again")))}))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"onDelete",value:function(){b.popMessage("".concat(this.props.match.params.type," deleted successfully"));var e=this.props.history;e.length>2?e.goBack():e.push("/feed")}},{key:"render",value:function(){var e=this,t=this.props.match.path;return!1===this.state.post?r.a.createElement("div",null,r.a.createElement("span",{className:"fa fa-spinner fa-spin loader"})):null===this.state.post?r.a.createElement(F,this.props):r.a.createElement("div",null,r.a.createElement(d.c,null,r.a.createElement(d.a,{path:"".concat(t,"/edit"),render:function(t){return r.a.createElement(ce,Object.assign({},e.props,t,{post:ue({},e.state.post,{type:e.props.match.params.type})}))}}),r.a.createElement(d.a,{path:"".concat(t,"/"),render:function(t){return r.a.createElement(X,Object.assign({},e.props,t,{post:ue({},e.state.post,{type:e.props.match.params.type}),onDelete:e.onDelete,preview:!0}))}})))}}]),t}(r.a.Component);a(51),a(52);function me(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function de(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?me(a,!0).forEach((function(t){Object(f.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):me(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var fe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={articles:[],loading:!0},a._isMounted=!1,a.fetchRequest=a.props.fetchRequest,a.onDelete=a.onDelete.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,this.props.mountProfileView("articles"),this.fetchRequest({url:"https://akintomiwa-capstone-backend.herokuapp.com/api/v1/users/".concat(this.props.sessionUser.id,"/articles")}).then((function(t){e._isMounted&&e.setState((function(){return{articles:t,loading:!1}}))}))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"onDelete",value:function(e){for(var t=this.state.articles,a=[],n=0;n<t.length;n+=1)t[n].id!==e.id&&a.push(t[n]);this.setState((function(){return{articles:a}})),b.popMessage("article deleted successfully")}},{key:"render",value:function(){if(this.state.loading)return r.a.createElement("div",null,r.a.createElement("span",{className:"loader fa fa-spinner fa-spin"}));var e=[],t=this.state.articles;if(0===t.length)return r.a.createElement("div",{className:"empty-profile-tab"},r.a.createElement("span",null," there are no articles to show "));for(var a=0;a<t.length;a+=1)e.push(r.a.createElement(X,Object.assign({},this.props,{post:de({},t[a],{type:"article"}),key:t[a].id,onDelete:this.onDelete})));return r.a.createElement("div",null,e)}}]),t}(r.a.Component);function he(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ge(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?he(a,!0).forEach((function(t){Object(f.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):he(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ve=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={gifs:[],loading:!0},a._isMounted=!1,a.fetchRequest=a.props.fetchRequest,a.onDelete=a.onDelete.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,this.props.mountProfileView("gifs"),this.fetchRequest({url:"https://akintomiwa-capstone-backend.herokuapp.com/api/v1/users/".concat(this.props.sessionUser.id,"/gifs")}).then((function(t){e._isMounted&&e.setState((function(){return{gifs:t,loading:!1}}))}))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"onDelete",value:function(e){for(var t=this.state.gifs,a=[],n=0;n<t.length;n+=1)t[n].id!==e.id&&a.push(t[n]);this.setState((function(){return{gifs:a}})),b.popMessage("gif deleted successfully")}},{key:"render",value:function(){if(this.state.loading)return r.a.createElement("div",null,r.a.createElement("span",{className:"loader fa fa-spinner fa-spin"}));var e=[],t=this.state.gifs;if(0===t.length)return r.a.createElement("div",{className:"empty-profile-tab"},r.a.createElement("span",null," there are no gifs to show "));for(var a=0;a<t.length;a+=1)e.push(r.a.createElement(X,Object.assign({},this.props,{post:ge({},t[a],{type:"gif"}),key:t[a].id,onDelete:this.onDelete})));return r.a.createElement("div",null,e)}}]),t}(r.a.Component),be=(a(53),function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.sessionUser;return r.a.createElement("div",{id:"userDetails"},r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"id"),r.a.createElement("td",null,e.id)),r.a.createElement("tr",null,r.a.createElement("td",null,"department"),r.a.createElement("td",null,e.departmentText)),r.a.createElement("tr",null,r.a.createElement("td",null,"job"),r.a.createElement("td",null,e.jobRoleText)),r.a.createElement("tr",null,r.a.createElement("td",null,"first name"),r.a.createElement("td",null,e.firstName)),r.a.createElement("tr",null,r.a.createElement("td",null,"last name"),r.a.createElement("td",null,e.lastName)),r.a.createElement("tr",null,r.a.createElement("td",null,"email"),r.a.createElement("td",null,e.email)),r.a.createElement("tr",null,r.a.createElement("td",null,"gender"),r.a.createElement("td",null,e.gender)),r.a.createElement("tr",null,r.a.createElement("td",null,"address"),r.a.createElement("td",null,e.address)),r.a.createElement("tr",null,r.a.createElement("td",null,"hired on"),r.a.createElement("td",null,b.getRelativeTime(e.hiredOn,!1))))))}}]),t}(r.a.Component));function ye(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ee(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ye(a,!0).forEach((function(t){Object(f.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ye(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Oe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={profileLoading:!0,profileView:"articles"},a._isMounted=!1,a.parallaxScroll=a.parallaxScroll.bind(Object(h.a)(a)),a.mountProfileView=a.mountProfileView.bind(Object(h.a)(a)),a.fetchRequest=a.props.fetchRequest,a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0,this.props.pageSwitch("profile"),this.setState((function(){return{profileLoading:!1}})),window.addEventListener("scroll",this.parallaxScroll)}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,window.removeEventListener("scroll",this.parallaxScroll)}},{key:"parallaxScroll",value:function(){var e=function(e){return document.querySelector(e)},t=e("#coverImage img"),a=e("#coverImage"),n=a.offsetHeight,r=b.getCordinates(a).top,s=a.offsetTop,o=r+n;if(r<=window.innerHeight&&o>=0){var i=(r-(s=s>window.innerHeight?window.innerHeight:s))/(s+n)*100/100*(t.offsetHeight-n);t.style.transform="translate3d(0px, ".concat(i,"px, 0px)")}}},{key:"mountProfileView",value:function(e){this.setState((function(){return{profileView:e}}))}},{key:"render",value:function(){var e=this;if(this.state.profileLoading)return r.a.createElement("div",null,r.a.createElement("span",{className:"fa fa-spinner fa-spin loader"}));for(var t=this.props.sessionUser,a=this.props.companyDeptStruc,n=a[t.department].name,s="",o=a[t.department].jobRoles,i=0;i<o.length;i+=1)if(o[i].id===t.jobRole){s=o[i].title;break}return r.a.createElement("div",null,r.a.createElement("div",{className:"top"},r.a.createElement("div",{id:"coverImage"},r.a.createElement("img",{src:E.a,alt:"cover"})),r.a.createElement("div",{id:"passport"},r.a.createElement("img",{src:t.passportUrl,alt:"m"})),r.a.createElement("div",{id:"userPreviewInfo"},r.a.createElement("h2",{className:"user-name"},t.firstName," ",t.lastName),r.a.createElement("p",{className:"info"},"#",t.id),r.a.createElement("p",{className:"info"},s," in ",n),r.a.createElement("p",{className:"info",title:b.getRelativeTime(t.hiredOn,!1)},"hired ",b.getRelativeTime(t.hiredOn))),r.a.createElement("div",{id:"profileHeader"},r.a.createElement(m.b,{to:"/profile/details",className:"link"},r.a.createElement("span",null,"Details"),r.a.createElement("div",null)),r.a.createElement(m.b,{className:"link",to:"/profile/articles",isActive:function(e,t){return!!e||-1!==["/profile","/profile/"].indexOf(t.pathname.toLowerCase())}},r.a.createElement("span",null,"articles"),r.a.createElement("div",null)),r.a.createElement(m.b,{to:"/profile/gifs",className:"link"},r.a.createElement("span",null,"gifs"),r.a.createElement("div",null)),r.a.createElement("div",{className:"link "},r.a.createElement("span",null,"team"),r.a.createElement("div",null)))),r.a.createElement("div",null,r.a.createElement(d.c,null,r.a.createElement(d.a,{path:"/profile/details",render:function(){return r.a.createElement(be,Object.assign({},e.props,{sessionUser:Ee({},e.props.sessionUser,{departmentText:n,jobRoleText:s})}))}}),r.a.createElement(d.a,{path:"/profile/gifs",render:function(t){return r.a.createElement(ve,Object.assign({},e.props,t,{mountProfileView:e.mountProfileView}))}}),r.a.createElement(d.a,{path:"/profile/articles",render:function(t){return r.a.createElement(fe,Object.assign({},e.props,t,{mountProfileView:e.mountProfileView}))}}),r.a.createElement(d.a,{path:"/profile",exact:!0,render:function(t){return r.a.createElement(fe,Object.assign({},e.props,t,{mountProfileView:e.mountProfileView}))}}))))}}]),t}(r.a.Component),je=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={pageComp:"",backBtn:!1},a.pageSwitch=a.pageSwitch.bind(Object(h.a)(a)),a.getPost=a.getPost.bind(Object(h.a)(a)),a.getCurrentPage=a.getCurrentPage.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"getPost",value:function(e){var t=this.props.fetchRequest;return new Promise((function(a,n){var r={id:"gif"===e.type?e.gifId:e.articleId,endpoint:"gif"===e.type?"gifs":"articles"};t({url:"https://akintomiwa-capstone-backend.herokuapp.com/api/v1/".concat(r.endpoint,"/").concat(r.id)}).then((function(e){a(e)})).catch((function(e){n(e)}))}))}},{key:"getCurrentPage",value:function(){return this.state.pageComp}},{key:"pageSwitch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.setState((function(){return{pageComp:e,backBtn:!!t}}))}},{key:"render",value:function(){var e=this,t=this.state.pageComp,a=this.state.backBtn?r.a.createElement("div",{className:"go-back",onClick:function(){e.props.history.goBack()}},r.a.createElement("div",{className:"fas fa-arrow-left"})):"",n="".concat(this.props.sessionUser.firstName," ").concat(this.props.sessionUser.lastName);return r.a.createElement("main",{id:"mainContentBlock","data-comp":t},r.a.createElement("div",{id:"contentHeader"},r.a.createElement("h1",{className:"page"},a,b.sepCamelWord(this.state.pageComp)),r.a.createElement("div",{className:"user-info"},r.a.createElement("h3",{className:"name"},n),r.a.createElement("div",{className:"passport"},r.a.createElement("img",{src:this.props.sessionUser.passportUrl,alt:n})))),r.a.createElement("div",{className:"container"},r.a.createElement(d.c,null,r.a.createElement(d.a,{path:"/create-user",render:function(t){return r.a.createElement(_,Object.assign({},e.props,t,{pageSwitch:e.pageSwitch,getPost:e.getPost,getCurrentPage:e.getCurrentPage}))}}),r.a.createElement(d.a,{path:"/reports",render:function(t){return r.a.createElement(T,Object.assign({},e.props,t,{pageSwitch:e.pageSwitch,getPost:e.getPost,getCurrentPage:e.getCurrentPage}))}}),r.a.createElement(d.a,{path:"/feeds",render:function(t){return r.a.createElement(ie,Object.assign({},e.props,t,{pageSwitch:e.pageSwitch,getPost:e.getPost,getCurrentPage:e.getCurrentPage}))}}),r.a.createElement(d.a,{path:"/post/:type/:id",render:function(t){return r.a.createElement(pe,Object.assign({},e.props,t,{pageSwitch:e.pageSwitch,getPost:e.getPost,getCurrentPage:e.getCurrentPage}))}}),r.a.createElement(d.a,{path:"/profile",render:function(t){return r.a.createElement(Oe,Object.assign({},e.props,t,{pageSwitch:e.pageSwitch,getPost:e.getPost,getCurrentPage:e.getCurrentPage}))}}),r.a.createElement(d.a,{path:"/",exact:!0,render:function(t){return r.a.createElement(ie,Object.assign({},e.props,t,{pageSwitch:e.pageSwitch,getPost:e.getPost,getCurrentPage:e.getCurrentPage}))}}),r.a.createElement(d.a,{render:function(t){return r.a.createElement(F,Object.assign({},e.props,t,{pageSwitch:e.pageSwitch,getPost:e.getPost,getCurrentPage:e.getCurrentPage}))}}))))}}]),t}(r.a.Component),we=(a(54),function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{id:"updatesBlock"},r.a.createElement("h2",{className:"header"},"Notice board"),r.a.createElement("div",{className:"note","data-importance":"4"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"date-time"},"november 12, 9:30am"),r.a.createElement("div",{className:"msg"},"Lorem ipsum dolor sit amet consectetur adipisicing elit. Vitae odit reprehenderit quod blanditiis ratione recusandae at, magnam nobis eius harum nisi iusto libero, ea eveniet dolore? Omnis maxime nisi sapiente?"))),r.a.createElement("div",{className:"note","data-importance":"3"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"date-time"},"november 10, 11:59am"),r.a.createElement("div",{className:"msg"},"Lorem ipsum dolor sit amet consectetur adipisicing elit. Vitae odit reprehenderit quod blanditiis ratione recusandae at, magnam nobis eius harum nisi iusto libero, ea eveniet dolore? Omnis maxime nisi sapiente?"))),r.a.createElement("div",{className:"note","data-importance":"2"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"date-time"},"november 8, 2:00pm"),r.a.createElement("div",{className:"msg"},"Lorem ipsum dolor sit amet consectetur adipisicing elit. Vitae odit reprehenderit quod blanditiis ratione recusandae at, magnam nobis eius harum nisi iusto libero, ea eveniet dolore? Omnis maxime nisi sapiente?"))),r.a.createElement("div",{className:"note",dataimportance:"1"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"date-time"},"november 6, 10:30am"),r.a.createElement("div",{className:"msg"},"Lorem ipsum dolor sit amet consectetur adipisicing elit. Vitae odit reprehenderit quod blanditiis ratione recusandae at, magnam nobis eius harum nisi iusto libero, ea eveniet dolore? Omnis maxime nisi sapiente?"))))}}]),t}(r.a.Component));a(55);function ke(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ne(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ke(a,!0).forEach((function(t){Object(f.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ke(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Pe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={sessionUser:{},companyDeptStruc:null,loading:!0},a._isMounted=!1,a.getUser=a.getUser.bind(Object(h.a)(a)),a.fetchRequest=a.fetchRequest.bind(Object(h.a)(a)),a.validateAdmin=a.validateAdmin.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0;var t=localStorage.getItem("sessionUserId");this.getUser(t).then((function(t){e._isMounted&&e.getCompanyDeptStruc().then((function(a){if(e._isMounted){e.setState((function(){return{companyDeptStruc:a}}));var n=e.validateAdmin(t);e.setState((function(){return{sessionUser:Ne({},t,{isAdmin:n}),loading:!1}}))}}))}))}},{key:"validateAdmin",value:function(e){for(var t=!1,a=this.state.companyDeptStruc[e.department].jobRoles,n=0;n<a.length;n+=1)if(a[n].id===e.jobRole){"admin"===a[n].title&&(t=!0);break}return t}},{key:"getCompanyDeptStruc",value:function(){var e=this;return new Promise((function(t){e.fetchRequest({url:"https://akintomiwa-capstone-backend.herokuapp.com/api/v1/jobs"}).then((function(e){t(e)}))}))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"getUser",value:function(e){var t=this,a=function(a){"Unauthorized"===a.message?t.props.history.push("/signin"):(b.popMessage(navigator.onLine?"oops! there was a server error":"can't connect to serve because you are offline, will retry in 5 seconds"),setTimeout((function(){b.popMessage("retrying to connect to server"),t.getUser(e)}),5e3))};return new Promise((function(t){var n=localStorage.getItem("sessionUserToken");b.isEmpty(e)||b.isEmpty(n)?a(new Error("Unauthorized")):fetch("https://akintomiwa-capstone-backend.herokuapp.com/api/v1/users/".concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){return e.json()})).then((function(e){if("success"===e.status){var n=e.data;t(n)}else a(new Error(e.error))})).catch((function(e){a(e)}))}))}},{key:"fetchRequest",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{url:"",method:"GET",body:{},headers:{}};return new Promise((function(a,n){var r=localStorage.getItem("sessionUserToken"),s=function(){setTimeout((function(){b.popMessage("retrying to connect to server"),e.fetchRequest(t).then(a).catch(n)}),5e3)},o=function(t){var a=t.message,r=t.status;"Unauthorized"===a?e.props.history.push("/signin"):500===r?(b.popMessage("oops! there was a server error"),s()):navigator.onLine?n(t):(b.popMessage("can't connect to serve because you are offline, will retry in 5 seconds"),s())};if(b.isEmpty(r)){var i=new Error("Unauthorized");i.status=401,o(i)}else{var c=null,l=b.isEmpty(t.method)?"GET":t.method.toUpperCase();fetch(t.url,{method:l,body:t.body,headers:Ne({},t.headers,{Authorization:"Bearer ".concat(r)})}).then((function(e){return c=e,e.json()})).then((function(e){if("success"===e.status){var t=e.data;a(t)}else{var n=new Error(c.statusText);n.status=c.status,n.body=e.error,o(n)}})).catch((function(e){o(e)}))}}))}},{key:"render",value:function(){return!1===this.state.loading?r.a.createElement("div",{id:"pageContent","data-page":"application"},r.a.createElement(S,Object.assign({},this.props,{sessionUser:this.state.sessionUser,fetchRequest:this.fetchRequest})),r.a.createElement(je,Object.assign({},this.props,{sessionUser:this.state.sessionUser,getUser:this.getUser,fetchRequest:this.fetchRequest,companyDeptStruc:this.state.companyDeptStruc})),r.a.createElement(we,null)):r.a.createElement("div",{id:"pageContent",className:"loading","data-page":"application"})}}]),t}(r.a.Component),De=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(m.a,null,r.a.createElement(d.c,null,r.a.createElement(d.a,{path:"/signin",render:function(e){return r.a.createElement(w,e)}}),r.a.createElement(d.a,{path:"/",render:function(e){return r.a.createElement(Pe,e)}}))))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(De,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}],[[27,1,2]]]);
//# sourceMappingURL=main.9d634775.chunk.js.map